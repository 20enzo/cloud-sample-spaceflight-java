'use strict';

const assert = require('assert');
const UriBuilder = require('../../../lib/uri/builder/UriBuilder');
const EdmPrimitiveTypeKind = require('../../../../lib/edm/EdmPrimitiveTypeKind');

describe(__filename, () => {
    describe('should test the ODataV4UriBuilder', () => {

        const test = data => {
            it(`should build uri "${data.uri}"`, () => {
                assert.equal(data.builder().getUrl(), data.uri);
            });
        };

        describe('should test batch and metadata', () => {

            it('should build the uri for $batch', () => {
                test({ builder: new UriBuilder().v4().batch(), uri: '$batch' });
            });

            it('should build the uri for $metadata', () => {
                test({ builder: new UriBuilder().v4().metadata(), uri: '$metadata' });
            });

        });

        describe('should test basic resource path', () => {
            const testdata = [
                // Entitysets with different kind of keys that get encoded implicitly by their type
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset'),
                    uri: 'entityset'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1),
                    uri: 'entityset(1)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(true),
                    uri: 'entityset(true)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key('1'),
                    uri: 'entityset(1)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key("'1'"),
                    uri: "entityset('1')"
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(Buffer.from('binarydata', 'utf-8'), EdmPrimitiveTypeKind.Binary),
                    uri: "entityset(binary'YmluYXJ5ZGF0YQ==')"
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(true, EdmPrimitiveTypeKind.Boolean),
                    uri: 'entityset(true)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(255, EdmPrimitiveTypeKind.Byte),
                    uri: 'entityset(255)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(1.79E+10, EdmPrimitiveTypeKind.Decimal),
                    uri: 'entityset(17900000000)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(123456.789, EdmPrimitiveTypeKind.Double),
                    uri: 'entityset(123456.789)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key('1234abcd-56ef-dc90-7f8e-a1b2c3d4e5f6', EdmPrimitiveTypeKind.Guid),
                    uri: 'entityset(1234abcd-56ef-dc90-7f8e-a1b2c3d4e5f6)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(32767, EdmPrimitiveTypeKind.Int16),
                    uri: 'entityset(32767)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(2147483647, EdmPrimitiveTypeKind.Int32),
                    uri: 'entityset(2147483647)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(Number.MAX_SAFE_INTEGER, EdmPrimitiveTypeKind.Int64),
                    uri: `entityset(${Number.MAX_SAFE_INTEGER})`
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(127, EdmPrimitiveTypeKind.SByte),
                    uri: 'entityset(127)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(3.4028234663852886E+38, EdmPrimitiveTypeKind.Single),
                    uri: 'entityset(3.4028234663852886e+38)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key('string', EdmPrimitiveTypeKind.String),
                    uri: "entityset('string')"
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key('2017-11-30', EdmPrimitiveTypeKind.Date),
                    uri: 'entityset(2017-11-30)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key('2017-11-30T13:24Z', EdmPrimitiveTypeKind.DateTimeOffset),
                    uri: 'entityset(2017-11-30T13:24Z)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key('23:59:59.00000', EdmPrimitiveTypeKind.TimeOfDay),
                    uri: 'entityset(23:59:59.00000)'
                },
                // compositeKeys
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .compositeKey('key1', 1)
                        .compositeKey('key2', 'string'),
                    uri: 'entityset(key1=1,key2=string)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .compositeKey('key1', 1, EdmPrimitiveTypeKind.Int16)
                        .compositeKey('key2', 'string', EdmPrimitiveTypeKind.String),
                    uri: "entityset(key1=1,key2='string')"
                },
                // $count
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .count(),
                    uri: 'entityset/$count'
                }
            ];

            for (const data of testdata) {
                test(data);
            }

        });

        describe('should test basic function calls', () => {
            const testdata = [
                {
                    builder: () => new UriBuilder().v4().functionImport('function'),
                    uri: 'function()'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1),
                    uri: 'function(parameter1=1)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', true),
                    uri: 'function(parameter1=true)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', '1'),
                    uri: 'function(parameter1=1)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', "'string'"),
                    uri: "function(parameter1='string')"
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', Buffer.from('binarydata', 'utf-8'), EdmPrimitiveTypeKind.Binary),
                    uri: "function(parameter1=binary'YmluYXJ5ZGF0YQ==')"
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', true, EdmPrimitiveTypeKind.Boolean),
                    uri: 'function(parameter1=true)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 128, EdmPrimitiveTypeKind.Byte),
                    uri: 'function(parameter1=128)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 128.5, EdmPrimitiveTypeKind.Decimal),
                    uri: 'function(parameter1=128.5)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 128.5, EdmPrimitiveTypeKind.Double),
                    uri: 'function(parameter1=128.5)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', '1234abcd-56ef-dc90-7f8e-a1b2c3d4e5f6', EdmPrimitiveTypeKind.Guid),
                    uri: 'function(parameter1=1234abcd-56ef-dc90-7f8e-a1b2c3d4e5f6)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1, EdmPrimitiveTypeKind.Int16),
                    uri: 'function(parameter1=1)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1, EdmPrimitiveTypeKind.Int32),
                    uri: 'function(parameter1=1)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', '9223372036854775807', EdmPrimitiveTypeKind.Int64),
                    uri: 'function(parameter1=9223372036854775807)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1, EdmPrimitiveTypeKind.SByte),
                    uri: 'function(parameter1=1)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1.5, EdmPrimitiveTypeKind.Single),
                    uri: 'function(parameter1=1.5)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', "it's a string", EdmPrimitiveTypeKind.String),
                    uri: "function(parameter1='it''s%20a%20string')"
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', '2018-06-07', EdmPrimitiveTypeKind.Date),
                    uri: 'function(parameter1=2018-06-07)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', '2018-06-07T20:00:55.789Z', EdmPrimitiveTypeKind.DateTimeOffset),
                    uri: 'function(parameter1=2018-06-07T20:00:55.789Z)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', '23:59:59.00000', EdmPrimitiveTypeKind.TimeOfDay),
                    uri: 'function(parameter1=23:59:59.00000)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1).parameter('parameter2', '2', EdmPrimitiveTypeKind.String),
                    uri: "function(parameter1=1,parameter2='2')"
                },
                // functionImport with keys
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .key(1),
                    uri: 'function()(1)'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .compositeKey('key1', 1)
                        .compositeKey('key2', 'string'),
                    uri: 'function()(key1=1,key2=string)'
                },
                // parameter and keys
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1).parameter('parameter2', '2', EdmPrimitiveTypeKind.String)
                        .key(1),
                    uri: "function(parameter1=1,parameter2='2')(1)"
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1)
                        .compositeKey('key1', 1)
                        .compositeKey('key2', 'string'),
                    uri: 'function(parameter1=1)(key1=1,key2=string)'
                },
                // $value and $count
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .value(),
                    uri: 'function()/$value'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .key(1)
                        .value(),
                    uri: 'function()(1)/$value'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .parameter('parameter1', 1)
                        .value(),
                    uri: 'function(parameter1=1)/$value'
                },
                {
                    builder: () => new UriBuilder().v4().functionImport('function')
                        .count(),
                    uri: 'function()/$count'
                }
            ];

            for (const data of testdata) {
                test(data);
            }
        });

        describe('should test basic query-options', () => {
            const testdata = [
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').top(10),
                    uri: 'entityset?$top=10'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').skip(10),
                    uri: 'entityset?$skip=10'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').inlineCount(),
                    uri: 'entityset?$count=true'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').select('Property1').select('Property2'),
                    uri: 'entityset?$select=Property1,Property2'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .orderby('Property1', 'asc').orderby('Property2', 'desc'),
                    uri: 'entityset?$orderby=Property1 asc,Property2 desc'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').expand('NavigationProperty1'),
                    uri: 'entityset?$expand=NavigationProperty1'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').filter('Property1 eq 5'),
                    uri: 'entityset?$filter=Property1 eq 5'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .query('custom', 'this is a custom query option'),
                    uri: 'entityset?custom=this is a custom query option'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').format('json'),
                    uri: 'entityset?$format=json'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').search('propertyvalue'),
                    uri: 'entityset?$search=propertyvalue'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').top(3).skip(5).inlineCount(false),
                    uri: 'entityset?$top=3&$skip=5&$count=false'
                }
            ];

            for (const data of testdata) {
                test(data);
            }

            it('should throw an error, if a wrong value fpr queryOption $count is provided', () => {
                assert.throws(() => {
                    new UriBuilder().v4().entitySet('entityset').inlineCount('true');
                });
            });
        });

        describe('should test resource path with navigation and properties', () => {

            const testdata = [
                // Navigation properties
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateSingle('navigationOne'),
                    uri: 'entityset(1)/navigationOne'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateSingle('navigationOne')
                        .navigateSingle('navigationOne'),
                    uri: 'entityset(1)/navigationOne/navigationOne'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateSingle('navigationOne')
                        .navigateCollection('navigationMany'),
                    uri: 'entityset(1)/navigationOne/navigationMany'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateSingle('navigationOne')
                        .navigateCollection('navigationMany').key(2)
                        .navigateSingle('navigationOne'),
                    uri: 'entityset(1)/navigationOne/navigationMany(2)/navigationOne'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany'),
                    uri: 'entityset(1)/navigationMany'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2),
                    uri: 'entityset(1)/navigationMany(2)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2)
                        .navigateSingle('navigationOne'),
                    uri: 'entityset(1)/navigationMany(2)/navigationOne'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2)
                        .navigateSingle('navigationOne')
                        .navigateCollection('navigationMany'),
                    uri: 'entityset(1)/navigationMany(2)/navigationOne/navigationMany'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2)
                        .navigateCollection('navigationMany').key(3),
                    uri: 'entityset(1)/navigationMany(2)/navigationMany(3)'
                },
                // Properties
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .primitiveProperty('primitiveProperty'),
                    uri: 'entityset(1)/primitiveProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexCollectionProperty('complexCollectionProperty'),
                    uri: 'entityset(1)/complexCollectionProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .primitiveCollectionProperty('primitiveCollectionProperty'),
                    uri: 'entityset(1)/primitiveCollectionProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexProperty('complexProperty'),
                    uri: 'entityset(1)/complexProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexProperty('complexProperty').primitiveProperty('primitiveProperty'),
                    uri: 'entityset(1)/complexProperty/primitiveProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexProperty('complexProperty').primitiveCollectionProperty('primitiveCollectionProperty'),
                    uri: 'entityset(1)/complexProperty/primitiveCollectionProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexProperty('complexProperty').complexProperty('complexProperty'),
                    uri: 'entityset(1)/complexProperty/complexProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexProperty('complexProperty')
                        .complexProperty('complexProperty')
                        .primitiveProperty('primitiveProperty'),
                    uri: 'entityset(1)/complexProperty/complexProperty/primitiveProperty'
                },
                // Navigation and Properties
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateSingle('navigationOne')
                        .primitiveProperty('primitiveProperty'),
                    uri: 'entityset(1)/navigationOne/primitiveProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2)
                        .primitiveProperty('primitiveProperty'),
                    uri: 'entityset(1)/navigationMany(2)/primitiveProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2)
                        .complexProperty('complexProperty'),
                    uri: 'entityset(1)/navigationMany(2)/complexProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2)
                        .complexProperty('complexProperty')
                        .primitiveProperty('primitiveProperty'),
                    uri: 'entityset(1)/navigationMany(2)/complexProperty/primitiveProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2)
                        .complexProperty('complexProperty')
                        .primitiveCollectionProperty('primitiveCollectionProperty'),
                    uri: 'entityset(1)/navigationMany(2)/complexProperty/primitiveCollectionProperty'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2)
                        .complexProperty('complexProperty')
                        .complexCollectionProperty('complexCollectionProperty'),
                    uri: 'entityset(1)/navigationMany(2)/complexProperty/complexCollectionProperty'
                },
                // $value and $count
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1).value(),
                    uri: 'entityset(1)/$value'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateSingle('navigationOne').value(),
                    uri: 'entityset(1)/navigationOne/$value'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .navigateCollection('navigationMany').key(2).value(),
                    uri: 'entityset(1)/navigationMany(2)/$value'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .primitiveProperty('primitiveProperty').value(),
                    uri: 'entityset(1)/primitiveProperty/$value'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .primitiveCollectionProperty('primitiveCollectionProperty').count(),
                    uri: 'entityset(1)/primitiveCollectionProperty/$count'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexCollectionProperty('complexCollectionProperty').count(),
                    uri: 'entityset(1)/complexCollectionProperty/$count'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexProperty('complexProperty').primitiveProperty('primitiveProperty').value(),
                    uri: 'entityset(1)/complexProperty/primitiveProperty/$value'
                }
            ];

            for (const data of testdata) {
                test(data);
            }

        });

        describe('should test resource path boundActions and boundFunctions', () => {

            const testdata = [
                // Different binding parameter types
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .boundFunction('namespace', 'boundFunction'),
                    uri: 'entityset/namespace.boundFunction()'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .boundFunction('namespace', 'boundFunction'),
                    uri: 'entityset(1)/namespace.boundFunction()'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .compositeKey('key1', 1)
                        .compositeKey('key2', 2)
                        .boundFunction('namespace', 'boundFunction'),
                    uri: 'entityset(key1=1,key2=2)/namespace.boundFunction()'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .primitiveProperty('primitiveProperty')
                        .boundFunction('namespace', 'boundFunction'),
                    uri: 'entityset(1)/primitiveProperty/namespace.boundFunction()'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .primitiveCollectionProperty('primitiveCollectionProperty')
                        .boundFunction('namespace', 'boundFunction'),
                    uri: 'entityset(1)/primitiveCollectionProperty/namespace.boundFunction()'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexProperty('complexProperty')
                        .boundFunction('namespace', 'boundFunction'),
                    uri: 'entityset(1)/complexProperty/namespace.boundFunction()'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset').key(1)
                        .complexCollectionProperty('complexCollectionProperty')
                        .boundFunction('namespace', 'boundFunction'),
                    uri: 'entityset(1)/complexCollectionProperty/namespace.boundFunction()'
                },
                // with parameters and keys
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .boundFunction('namespace', 'boundFunction')
                        .parameter('parameter', 'value'),
                    uri: 'entityset/namespace.boundFunction(parameter=value)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .boundFunction('namespace', 'boundFunction')
                        .parameter('parameter1', 1)
                        .parameter('parameter2', 2),
                    uri: 'entityset/namespace.boundFunction(parameter1=1,parameter2=2)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .boundFunction('namespace', 'boundFunction')
                        .parameter('parameter', 1)
                        .key(2),
                    uri: 'entityset/namespace.boundFunction(parameter=1)(2)'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .boundFunction('namespace', 'boundFunction')
                        .parameter('parameter1', 1)
                        .parameter('parameter2', 2)
                        .compositeKey('key1', 3)
                        .compositeKey('key2', 4),
                    uri: 'entityset/namespace.boundFunction(parameter1=1,parameter2=2)(key1=3,key2=4)'
                },
                // Bound actions with different binding parameters
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .boundAction('namespace', 'boundAction'),
                    uri: 'entityset/namespace.boundAction'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .key(1)
                        .boundAction('namespace', 'boundAction'),
                    uri: 'entityset(1)/namespace.boundAction'
                },
                {
                    builder: () => new UriBuilder().v4().entitySet('entityset')
                        .compositeKey('key1', 1)
                        .compositeKey('key2', 2)
                        .boundAction('namespace', 'boundAction'),
                    uri: 'entityset(key1=1,key2=2)/namespace.boundAction'
                }
            ];

            for (const data of testdata) {
                test(data);
            }

        });
    });
});
