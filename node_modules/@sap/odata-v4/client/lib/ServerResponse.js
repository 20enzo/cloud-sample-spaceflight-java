const EventEmitter = require('events').EventEmitter;


class ServerResponse extends EventEmitter {

    constructor(response, rawPayload) {
        super();
        this._response = response;
        this._rawPayload = rawPayload;
        this._formatManger = null;
    }

    setFormatManager(manager) {
        this._formatManger = manager;
        return this;
    }

    setRequest(request) {
        this._request = request;
        return this;
    }

    getRequest() {
        return this._request;
    }

    getStatusCode() {
        return this._response.statusCode;
    }

    getHeaders() {
        return this._response.headers;
    }

    getHeader(name) {
        return this.getHeaders()[name];
    }

    getBody() {
        const deserializer = this._formatManger.getDeserializer(this);
        return deserializer();
    }

    getRawBody() {
        return this._rawPayload;
    }

}

module.exports = ServerResponse;
